<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Page History Navigator</title>
  <style>
    html, body {
      margin: 0; padding: 8px;
      box-sizing: border-box;
      overflow-x: hidden;
      font-family: sans-serif;
      height: 100%;
    }
    *, *::before, *::after { box-sizing: inherit; }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    .title {
      margin: 0;
      font-size: 16px;
      color: rgba(0, 0, 0, 0.5);
    }
    #clearBtn {
      all: unset; cursor: pointer; font-size: 16px; padding: 4px;
    }
    #clearBtn:hover {
      background: #f0f0f0; border-radius: 4px;
    }

    #historyList {
      width: 100%; list-style: none; padding: 0; margin: 0;
      overflow-y: auto; overflow-x: hidden; max-height: calc(100% - 40px);
    }
    li { margin-bottom: 4px; }

    button.entry {
      all: unset; display: flex; align-items: flex-start;
      width: 274px; padding: 4px 6px;
      border: 1px solid #ccc; border-radius: 4px;
      cursor: pointer; overflow: hidden;
    }
    button.entry:hover { background: #f0f0f0; }

    .entry-icon { flex: 0 0 20px; margin-right: 6px; }
    .entry-content { flex: 1; overflow: hidden; }
    .entry-page {
      font-size: 12px; font-weight: bold; margin: 0 0 2px;
      white-space: nowrap; text-overflow: ellipsis; overflow: hidden;
    }
    .entry-frame {
      font-size: 14px; margin: 0;
      white-space: nowrap; text-overflow: ellipsis; overflow: hidden;
    }
  </style>
</head>
<body>
  <div class="header">
    <h2 class="title">Recent</h2>
    <button id="clearBtn">ðŸ§¹</button>
  </div>
  <ul id="historyList">
    <li><i>Loadingâ€¦</i></li>
  </ul>

  <script>
    // Inline SVGs from your files
    var ICON_SVG = {
      COMPONENT: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <path fill-rule="evenodd" clip-rule="evenodd"
                       d="M7.96966 10.4444L6.59105 11.823C6.49341 11.9207 6.49341 12.079
                          6.59105 12.1766L7.96977 13.5553C8.06741 13.6529 8.2257 13.6529
                          8.32333 13.5553L9.70195 12.1767C9.79958 12.0791 9.79958 11.9208
                          9.70195 11.8231L8.32322 10.4444C8.22559 10.3468 8.0673 10.3468
                          7.96966 10.4444ZM9.02968 9.73666C8.54147 9.24915 7.7505 9.24937
                          7.26256 9.73731L5.88394 11.1159C5.39578 11.6041 5.39578 12.3955
                          5.88394 12.8837L7.26267 14.2624C7.75082 14.7506 8.54228 14.7506
                          9.03043 14.2624L10.4091 12.8838C10.4093 12.8836 10.4095 12.8833
                          10.4098 12.8831C10.8972 12.3948 10.897 11.6039 10.4091 11.116L9.03032
                          9.73731C9.03011 9.73709 9.0299 9.73688 9.02968 9.73666ZM11.1169
                          13.5902C11.1167 13.5904 11.1164 13.5907 11.1162 13.5909L9.73754
                          14.9695C9.24939 15.4577 9.24939 16.2491 9.73754 16.7373L11.1162
                          18.1159C11.6043 18.6041 12.3958 18.6041 12.8839 18.1159L14.2626
                          16.7373C14.7505 16.2494 14.7507 15.4585 14.2633 14.9703C14.2631
                          14.97 14.2628 14.9698 14.2626 14.9695L12.8839 13.5909C12.8838
                          13.5907 12.8836 13.5906 12.8834 13.5904C12.3955 13.103 11.6049
                          13.1029 11.1169 13.5902ZM9.73679 9.02956C9.737 9.02977 9.73722
                          9.02999 9.73743 9.0302L11.1162 10.4089C11.1163 10.4091 11.1165
                          10.4093 11.1167 10.4095C11.6049 10.8971 12.3959 10.8969 12.8839
                          10.4089L14.2627 9.03019C14.7508 8.54204 14.7508 7.75058 14.2627
                          7.26242L12.8839 5.88369C12.3958 5.39554 11.6043 5.39554 11.1162
                          5.88369L9.73743 7.26244C9.24949 7.75038 9.24928 8.54135 9.73679
                          9.02956ZM10.4445 8.3231L11.8233 9.70182C11.9209 9.79946 12.0792
                          9.79946 12.1768 9.70182L13.5556 8.32308C13.6532 8.22545 13.6532
                          8.06716 13.5556 7.96953L12.1768 6.5908C12.0792 6.49317 11.9209
                          6.49317 11.8233 6.5908L10.4445 7.96954C10.3469 8.06717 10.3469
                          8.22546 10.4445 8.3231ZM14.9698 9.7373L13.591 11.116C13.1029
                          11.6042 13.1029 12.3956 13.591 12.8838L14.9697 14.2624C15.4578
                          14.7506 16.2493 14.7506 16.7374 14.2624L18.1162 12.8837C18.6043
                          12.3955 18.6043 11.6041 18.1162 11.1159L16.7375 9.7373C16.2494
                          9.24914 15.4579 9.24914 14.9698 9.7373ZM15.6769 10.4444L14.2981
                          11.8231C14.2005 11.9208 14.2005 12.0791 14.2981 12.1767L15.6768
                          13.5553C15.7744 13.653 15.9327 13.653 16.0303 13.5553L17.4091
                          12.1766C17.5067 12.079 17.5067 11.9207 17.4091 11.823L16.0304
                          10.4444C15.9328 10.3468 15.7745 10.3468 15.6769 10.4444ZM13.5555
                          15.6766L12.1768 14.298C12.0792 14.2004 11.9209 14.2004 11.8233
                          14.298L10.4446 15.6766C10.347 15.7743 10.347 15.9326 10.4446
                          16.0302L11.8233 17.4088C11.9209 17.5065 12.0792 17.5065 12.1768
                          17.4088L13.5555 16.0302C13.6531 15.9326 13.6531 15.7743 13.5555
                          15.6766Z" fill="black" fill-opacity="0.9"/>
               </svg>`,
      INSTANCE: `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <path d="M7 12H17" stroke="#4A4A4A" stroke-width="2" stroke-linecap="round"/>
                 <path d="M10 9L7 12L10 15" stroke="#4A4A4A" stroke-width="2"
                       stroke-linecap="round" stroke-linejoin="round"/>
                 <path d="M14 9L17 12L14 15" stroke="#4A4A4A" stroke-width="2"
                       stroke-linecap="round" stroke-linejoin="round"/>
               </svg>`,
      GROUP:     `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <rect x="5" y="5" width="10" height="10" stroke="#4A4A4A" stroke-width="2"/>
                 <rect x="9" y="9" width="10" height="10" stroke="#4A4A4A" stroke-width="2"/>
               </svg>`,
      FRAME:     `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <rect x="3" y="3" width="18" height="18" stroke="#4A4A4A" stroke-width="2"/>
               </svg>`,
      SECTION:   `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <path d="M3 7H21" stroke="#4A4A4A" stroke-width="2"/>
                 <rect x="3" y="10" width="18" height="11" stroke="#4A4A4A" stroke-width="2"/>
               </svg>`,
      PAGE:      `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <path d="M4 2H14L20 8V22H4V2Z" stroke="#4A4A4A" stroke-width="2"/>
                 <path d="M14 2V8H20" stroke="#4A4A4A" stroke-width="2"/>
               </svg>`,
      IMAGE:     `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <rect x="3" y="3" width="18" height="18" stroke="#4A4A4A" stroke-width="2"/>
                 <path d="M3 17L9 11L14 16L21 9" stroke="#4A4A4A" stroke-width="2"/>
                 <circle cx="18" cy="6" r="2" fill="#4A4A4A"/>
               </svg>`,
      VECTOR:    `<svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                   xmlns="http://www.w3.org/2000/svg">
                 <polyline points="6,18 18,6" stroke="#4A4A4A" stroke-width="2" fill="none"/>
                 <polyline points="12,6 18,6 18,12" stroke="#4A4A4A" stroke-width="2" fill="none"/>
               </svg>`,
      TEXT:      `<svg width="24" height="24" viewBox="0 0 24 24"
                   xmlns="http://www.w3.org/2000/svg">
                 <text x="4" y="18" font-family="sans-serif" font-size="16" fill="#4A4A4A">T</text>
               </svg>`,
      DEFAULT:   `<svg width="24" height="24" viewBox="0 0 24 24" fill="#4A4A4A"
                   xmlns="http://www.w3.org/2000/svg">
                 <rect x="10" y="10" width="4" height="4"/>
               </svg>`
    };

    function getIcon(type) {
      return ICON_SVG[type] || ICON_SVG.DEFAULT;
    }

    function navigate(i) {
      parent.postMessage({ pluginMessage: { type: 'navigateTo', index: i } }, '*');
    }

    window.onload = function() {
      parent.postMessage({ pluginMessage: { type: 'getHistory' } }, '*');

      window.onmessage = function(e) {
        var msg = e.data.pluginMessage;
        if (msg.type === 'history') {
          var list = document.getElementById('historyList');
          list.innerHTML = '';
          if (!msg.history.length) {
            list.innerHTML = '<li><i>History is empty.</i></li>';
            return;
          }
          msg.history.forEach(function(entry, idx) {
            var li = document.createElement('li');
            var btn = document.createElement('button');
            btn.className = 'entry';
            btn.innerHTML =
              '<div class="entry-icon">' + getIcon(entry.nodeType) + '</div>' +
              '<div class="entry-content">' +
                '<p class="entry-page">' + entry.pageName + '</p>' +
                '<p class="entry-frame">' + (entry.nodeName||'') + '</p>' +
              '</div>';
            btn.onclick = function() { navigate(idx); };
            li.appendChild(btn);
            list.appendChild(li);
          });
        }
      };

      document.getElementById('clearBtn').onclick = function() {
        parent.postMessage({ pluginMessage: { type: 'clearHistory' } }, '*');
      };
    };
  </script>
</body>
</html>
